# -*- coding: utf-8 -*-
"""Extract MFCC with Python.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JkjAe_VZ9yD-BUJlsEDURoOSWYpHbsl3
"""

import librosa
import librosa.display
import IPython
import matplotlib.pyplot as plt
import numpy as np

#load an audio file
audio_file = "/sample-3s.wav"

#play the audio file
IPython.display.Audio(audio_file)

"""load the audio file"""

#load the audio file using Librosa as a wave form/signal
signal, sr= librosa.load(audio_file)

#show the number of samples in the signal
signal.shape

"""Extract mfcc"""

#extract mfcc
mfcc = librosa.feature.mfcc(y=signal, n_mfcc=13, sr=sr)

#print the shape of mfcc matrix
mfcc.shape
#rows are the number of discrete time frames

#visualize mfcc
plt.figure(figsize=(5,2))

#show heat map
librosa.display.specshow(mfcc, x_axis="time", sr=sr)

#show the map colors to numerical valuse
plt.colorbar(format="%+2f")

#show the plot
plt.show

"""Delta mfcc"""

#calculate first derivative of mfcc (delta mfcc)
delta_mfcc = librosa.feature.delta(mfcc)

#show the shape of the delta mfcc
#it should be the same shape of mfcc matrix
delta_mfcc.shape

#visualize delta-mfcc
#show heat map
librosa.display.specshow(delta_mfcc, x_axis="time", sr=sr)

#show the map colors to numerical valuse
plt.colorbar(format="%+2f")

#show the plot
plt.show

"""Delta-delta mfcc"""

#calculate the second derivative of mfcc (delta2)
delta2_mfcc = librosa.feature.delta(mfcc, order=2)

#visualize delta2-mfcc
#show heat map
librosa.display.specshow(delta2_mfcc, x_axis="time", sr=sr)

#show the map colors to numerical valuse
plt.colorbar(format="%+2f")

#show the plot
plt.show

"""Concatenate mfccs"""

#concatenate mfccs
comprehensive_mfcc = np.concatenate((mfcc, delta_mfcc, delta2_mfcc))

#the number of rows should be X3 of mfcc and number of columns remain the same
comprehensive_mfcc.shape

"""# New Section"""